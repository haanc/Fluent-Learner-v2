# Implementation Plan: Epic 2 - Data Core (Retrospective)

æœ¬è®¡åˆ’è®°å½•äº†æŒä¹…åŒ–æ•°æ®å±‚ä¸å‰åç«¯é€šä¿¡é“¾è·¯çš„å®ç°ç»†èŠ‚ã€‚

## ğŸ¯ ç›®æ ‡
*   å»ºç«‹åŸºäº UUID çš„ SQLite æ•°æ®åº“æ¶æ„ã€‚
*   å»ºç«‹ç±»å‹å®‰å…¨çš„ CRUD æ¥å£ã€‚
*   å®ç°å‰ç«¯è‡ªåŠ¨åŒ–çš„æ•°æ®åŒæ­¥ (React Query)ã€‚

## ğŸ› ï¸ å·²å®æ–½çš„æ›´æ”¹

### Data Layer (Python + SQLModel)
#### [NEW] [models.py](file:///c:/Users/hancao/.gemini/antigravity/scratch/language-learner/fluent-learner-v2/backend/models.py)
*   å®šä¹‰ [MediaSource](file:///c:/Users/hancao/.gemini/antigravity/scratch/language-learner/fluent-learner-v2/src/services/api.ts#5-14) (UUID, path, title)ã€‚
*   å®šä¹‰ [SubtitleSegment](file:///c:/Users/hancao/.gemini/antigravity/scratch/language-learner/fluent-learner-v2/src/services/api.ts#15-25) (UUID, media_id, text, timestamps)ã€‚

#### [NEW] [database.py](file:///c:/Users/hancao/.gemini/antigravity/scratch/language-learner/fluent-learner-v2/backend/database.py)
*   é…ç½® SQLite å¼•æ“ã€‚
*   å®ç° [create_db_and_tables](file:///c:/Users/hancao/.gemini/antigravity/scratch/language-learner/fluent-learner-v2/backend/database.py#11-13) è‡ªåŠ¨è¿ç§»é€»è¾‘ã€‚

### Backend API (FastAPI)
#### [MODIFY] [main.py](file:///c:/Users/hancao/.gemini/antigravity/scratch/language-learner/fluent-learner-v2/backend/main.py)
*   æ·»åŠ  `GET /media` (åˆ—è¡¨)ã€‚
*   æ·»åŠ  `POST /media` (å…¥åº“)ã€‚
*   æ·»åŠ  `GET /media/{id}/segments` (å­—å¹•)ã€‚

### Frontend (React Services)
#### [NEW] [api.ts](file:///c:/Users/hancao/.gemini/antigravity/scratch/language-learner/fluent-learner-v2/src/services/api.ts)
*   å®šä¹‰ TypeScript æ¥å£ã€‚
*   å°è£… Axios å¼‚æ­¥è¯·æ±‚ã€‚

#### [NEW] [useMedia.ts](file:///c:/Users/hancao/.gemini/antigravity/scratch/language-learner/fluent-learner-v2/src/hooks/useMedia.ts)
*   å°è£… React Query Hooksã€‚
*   å®ç°æœ¬åœ°ç¼“å­˜ä¸è‡ªåŠ¨é‡åˆ·ã€‚

## âœ… éªŒè¯ç»“æœ
*   **DB è‡ªåŠ¨ç”Ÿæˆ**: å¯åŠ¨åæˆåŠŸç”Ÿæˆ [learning.db](file:///c:/Users/hancao/.gemini/antigravity/scratch/language-learner/fluent-learner-v2/backend/learning.db)ã€‚
*   **API è¿é€š**: ä½¿ç”¨ PowerShell `Invoke-RestMethod` éªŒè¯ CRUD é€»è¾‘é€šè¿‡ã€‚
*   **å‰ç«¯æ¸²æŸ“**: UI ä¸‹æ–¹æˆåŠŸæ˜¾ç¤º `Total Media` ç»Ÿè®¡æ•°å­—ï¼Œè¯æ˜è¿é€šç‡ 100%ã€‚
