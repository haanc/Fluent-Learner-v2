# Project Phase 1 Detailed Plan v1: The Interactive Player

è¿™ä¸ªæ–‡æ¡£å°† Phase 1 æ‹†è§£ä¸ºå¯æ‰§è¡Œçš„å¾®å°æ­¥éª¤ã€‚æ¯ä¸€æ­¥éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„commitç‚¹ã€‚

## ğŸ—ï¸ Epic 1: Scaffold & Tech Spike (åŸºç¡€æ¶æ„ä¸æŠ€æœ¯æ¢é’ˆ)
ç›®æ ‡ï¼šæ­å»º Electron + React + Python ç¯å¢ƒï¼Œå¹¶éªŒè¯è§†é¢‘æ’­æ”¾èƒ½åŠ›ã€‚

### Step 1.1: Project Init (Hello World)
*   **ç”¨é€”**: å»ºç«‹çº¯å‡€çš„é¡¹ç›®éª¨æ¶ã€‚
*   **æŠ€æœ¯**: `npm create electron-vite`, React, TypeScript.
*   **å®ç°**: åˆ›å»º `fluent-learner-v2` ç›®å½•ï¼Œæ¸…ç†é»˜è®¤æ¨¡æ¿ä»£ç ï¼Œç¡®ä¿èƒ½ `npm run dev` å¯åŠ¨ä¸€ä¸ªæ˜¾ç¤º "Hello World" çš„çª—å£ã€‚
*   **éªŒè¯**: çœ‹åˆ°ç™½è‰²çª—å£ï¼Œæ§åˆ¶å°æ— æŠ¥é”™ã€‚

### Step 1.2: Python Backend Integration
*   **ç”¨é€”**: éªŒè¯ Electron ä¸»è¿›ç¨‹èƒ½å¯åŠ¨ Python å­è¿›ç¨‹ã€‚
*   **æŠ€æœ¯**: `python-shell` æˆ–ä½¿ç”¨ Node `child_process.spawn`. FastAPI (Python).
*   **å®ç°**: åˆ›å»º `backend/main.py` (FastAPI)ï¼Œåœ¨ Electron å¯åŠ¨æ—¶åœ¨åå°é™é»˜å¯åŠ¨å®ƒã€‚
*   **éªŒè¯**: Electron å‰ç«¯è®¿é—® `localhost:8000/health` èƒ½æ”¶åˆ° `{status: "ok"}`ã€‚

### Step 1.3: HTML5 Video Verification
*   **ç”¨é€”**: éªŒè¯ä¸éœ€è¦å¤æ‚çš„ native playerï¼Œåªéœ€ `<video>` æ ‡ç­¾å³å¯æ’­æ”¾æœ¬åœ°æ–‡ä»¶ã€‚
*   **æŠ€æœ¯**: React `<video>`, Electron `protocol.registerFileProtocol` (è§£å†³æœ¬åœ°æ–‡ä»¶å®‰å…¨ç­–ç•¥é—®é¢˜)ã€‚
*   **å®ç°**: åœ¨ç•Œé¢æ”¾ä¸€ä¸ª `<video src="file:///C:/test.mp4">`ï¼Œå¹¶ç¡®ä¿å®ƒèƒ½æ’­æ”¾ã€‚
*   **éªŒè¯**: è§†é¢‘æˆåŠŸåŠ è½½å’Œæ’­æ”¾ï¼Œå£°éŸ³æ­£å¸¸ã€‚

### Step 1.4: Overlay Interaction Spike
*   **ç”¨é€”**: éªŒè¯æ ¸å¿ƒä½“éªŒâ€”â€”â€œè§†é¢‘ä¸Šçš„æ–‡å­—â€ã€‚
*   **æŠ€æœ¯**: CSS Absolute Positioning, `z-index`.
*   **å®ç°**: åœ¨è§†é¢‘ä¸Šæ–¹è¦†ç›–ä¸€ä¸ªåŠé€æ˜çš„ `div`ï¼Œé‡Œé¢å†™ä¸€è¡Œå­— "Click Me"ã€‚ç‚¹å‡»å®ƒå¼¹å‡º `alert`ï¼Œè€Œä¸å½±å“è§†é¢‘æ’­æ”¾ï¼ˆä¸æš‚åœï¼‰ã€‚
*   **éªŒè¯**: æ–‡å­—æ‚¬æµ®åœ¨è§†é¢‘ä¸Šï¼Œç‚¹å‡»æ–‡å­—è§†é¢‘ç»§ç»­æ’­æ”¾ï¼Œç‚¹å‡»äº¤äº’å“åº”çµæ•ã€‚

---

## ğŸ’¾ Epic 2: Data Core (æ•°æ®å†…æ ¸)
ç›®æ ‡ï¼šå»ºç«‹åŸºäº UUID çš„ SQLite æ•°æ®åº“ï¼Œå¹¶æ‰“é€šå‰åç«¯æ•°æ®æµã€‚

### Step 2.1: Python SQLModel Setup
*   **ç”¨é€”**: å®šä¹‰æ•°æ®ç»“æ„ã€‚
*   **æŠ€æœ¯**: SQLModel (Python), SQLite.
*   **å®ç°**: åˆ›å»º `backend/database.py` å’Œ `backend/models.py`ã€‚å®šä¹‰ `MediaSource` å’Œ `SubtitleSegment` ç±»ã€‚
*   **éªŒè¯**: è¿è¡Œè„šæœ¬èƒ½ç”Ÿæˆ `learning.db` æ–‡ä»¶ã€‚

### Step 2.2: Python CRUD API
*   **ç”¨é€”**: å‰ç«¯æ“ä½œæ•°æ®çš„æ¥å£ã€‚
*   **æŠ€æœ¯**: FastAPI Routes.
*   **å®ç°**: ç¼–å†™ `/api/media/list`, `/api/media/create` ç­‰åŸºç¡€æ¥å£ã€‚
*   **éªŒè¯**: ä½¿ç”¨ Postman æˆ– Swagger UI èƒ½æˆåŠŸæ’å…¥å’ŒæŸ¥è¯¢æ•°æ®ã€‚

### Step 2.3: Frontend Data Hook
*   **ç”¨é€”**: å‰ç«¯ä¼˜é›…åœ°è°ƒç”¨åç«¯ã€‚
*   **æŠ€æœ¯**: React Query (TanStack Query), Axios.
*   **å®ç°**: å°è£… `useMediaList()` hookã€‚
*   **éªŒè¯**: React ç»„ä»¶èƒ½æ¸²æŸ“å‡ºä» Python åç«¯è¯»æ¥çš„åˆ—è¡¨ï¼ˆå³ä¾¿æ˜¯ç©ºåˆ—è¡¨ï¼‰ã€‚

---

## ğŸ¬ Epic 3: The Immersive Player (æ ¸å¿ƒæ’­æ”¾å™¨)
ç›®æ ‡ï¼šå®ç°â€œè§†é¢‘ + æ»šåŠ¨å­—å¹•â€çš„å®Œæ•´äº¤äº’ã€‚

### Step 3.1: Subtitle Data Rendering
*   **ç”¨é€”**: å°†å­—å¹•æ•°æ®æ¸²æŸ“åˆ°ä¾§è¾¹æ ã€‚
*   **æŠ€æœ¯**: React Virtualized List (æ€§èƒ½ä¼˜åŒ–), TailwindCSS.
*   **å®ç°**: åˆ›å»º `SubtitleSidebar` ç»„ä»¶ï¼Œæ¥æ”¶ä¸€ä¸ª mock json å­—å¹•æ•°ç»„å¹¶æ¸²æŸ“ã€‚
*   **éªŒè¯**: èƒ½æµç•…æ¸²æŸ“ 1000 è¡Œå­—å¹•åˆ—è¡¨ã€‚

### Step 3.2: Sync: Video to Subtitle (è§†é¢‘ -> å­—å¹•)
*   **ç”¨é€”**: è§†é¢‘æ’­æ”¾æ—¶ï¼Œå­—å¹•è‡ªåŠ¨æ»šåŠ¨åˆ°å¯¹åº”è¡Œã€‚
*   **æŠ€æœ¯**: `video.ontimeupdate`, `useEffect`.
*   **å®ç°**: ç›‘å¬è§†é¢‘æ—¶é—´ï¼Œè®¡ç®—å½“å‰æ˜¯ç¬¬å‡ å¥ï¼Œé«˜äº®è¯¥å¥ï¼Œå¹¶ `scrollIntoView`ã€‚
*   **éªŒè¯**: æ’­æ”¾è§†é¢‘ï¼Œå³ä¾§å­—å¹•åƒå¡æ‹‰OKä¸€æ ·è‡ªåŠ¨é«˜äº®æ»šåŠ¨ã€‚

### Step 3.3: Sync: Subtitle to Video (å­—å¹• -> è§†é¢‘)
*   **ç”¨é€”**: ç‚¹å‡»å­—å¹•è·³è½¬è§†é¢‘ã€‚
*   **æŠ€æœ¯**: `video.currentTime`.
*   **å®ç°**: ç‚¹å‡»ä¾§è¾¹æ æŸè¡Œï¼Œè§†é¢‘è·³è½¬åˆ°è¯¥å¥çš„ `start_time`ã€‚
*   **éªŒè¯**: ç‚¹å‡»å­—å¹•ï¼Œè§†é¢‘ç”»é¢ç¬é—´è·³è½¬å®šä½ã€‚

### Step 3.4: On-Demand Popover (å³æ—¶æŸ¥è¯ UI)
*   **ç”¨é€”**: ç‚¹å‡»ç”Ÿè¯å¼¹å‡ºèœå•ã€‚
*   **æŠ€æœ¯**: Radix UI Popover / Floating UI.
*   **å®ç°**: ç‚¹å‡»å­—å¹•ä¸­çš„å•è¯ï¼Œåœ¨å•è¯ä¸Šæ–¹æ‚¬æµ®æ˜¾ç¤ºä¸€ä¸ªæ°”æ³¡å¡ç‰‡ã€‚
*   **éªŒè¯**: æ°”æ³¡èƒ½å¤Ÿå‡†ç¡®è·Ÿéšæ–‡å­—ä½ç½®ï¼Œå³ä¾¿çª—å£ç¼©æ”¾ä¹Ÿä¸åç§»ã€‚

---

## ğŸ“‚ Epic 4: Library & Import (èµ„æºåº“ä¸å¯¼å…¥)
ç›®æ ‡ï¼šè®©ç”¨æˆ·èƒ½å¯¼å…¥è‡ªå·±çš„æ–‡ä»¶ã€‚

### Step 4.1: Drag & Drop Import
*   **ç”¨é€”**: ç®€å•çš„æ–‡ä»¶å¯¼å…¥ã€‚
*   **æŠ€æœ¯**: React Dropzone.
*   **å®ç°**: é¦–é¡µæ¥æ”¶æ–‡ä»¶æ‹–æ‹½ï¼Œè·å–æ–‡ä»¶æœ¬åœ°è·¯å¾„ã€‚
*   **éªŒè¯**: æ‹–å…¥æ–‡ä»¶ï¼Œæ§åˆ¶å°æ‰“å°å‡ºç»å¯¹è·¯å¾„ã€‚

### Step 4.2: Whisper Integration (Placeholder)
*   **ç”¨é€”**: æ¨¡æ‹Ÿ AI å¤„ç†æµç¨‹ï¼ˆå…ˆä¸æ¥çœŸ AIï¼Œè·‘é€šæµç¨‹ï¼‰ã€‚
*   **æŠ€æœ¯**: Python `asyncio.sleep`.
*   **å®ç°**: ç‚¹å‡»å¤„ç†ï¼ŒPython åç«¯æ¨¡æ‹Ÿ 3ç§’åŠ è½½ï¼Œç„¶åè¿”å› Mock çš„å­—å¹•æ•°æ®å­˜å…¥ DBã€‚
*   **éªŒè¯**: å¯¼å…¥è§†é¢‘ -> è¿›åº¦æ¡è·‘å®Œ -> è‡ªåŠ¨è·³è½¬åˆ° Library -> çœ‹åˆ°æ–°è§†é¢‘ã€‚

### Step 4.3: Real Whisper Integration (Real Deal)
*   **ç”¨é€”**: æ¥å…¥çœŸå® AIã€‚
*   **æŠ€æœ¯**: Azure OpenAI SDK / Local Whisper.
*   **å®ç°**: æ›¿æ¢ Step 4.2 çš„ Mock é€»è¾‘ï¼ŒçœŸæ­£è°ƒç”¨ Whisper API ç”Ÿæˆå­—å¹•ã€‚
*   **éªŒè¯**: å¯¼å…¥çœŸå®è§†é¢‘ï¼Œè·å¾—çœŸå®çš„å­—å¹•æ•°æ®ã€‚
